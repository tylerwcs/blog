<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>LazyAdmin [THM Walkthrough] | CS's Blog</title><meta name=keywords content="THM"><meta name=description content="LazyAdmin is a easy rated box on THM. It is a good box to brush up my skills and I learned a lot from it.
 Enumeration First, I run a Nmap scan and 2 open ports are found: port 80 and port 22
nmap --top-ports 50 10.10.127.148  Then, I run a gobuster scan to search for other subdirectories, and I found a /content subdirectory page.
 Exploitation I visit the page and found something new: SweetRice CMS."><meta name=author content="Me"><link rel=canonical href=http://tylerwcs.github.io/blog/posts/second/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.min.6afc038f23772af4637f04462c1d6ab9fc9fb9d097d6b1ae55481f131fc82eea.css integrity="sha256-avwDjyN3KvRjfwRGLB1qufyfudCX1rGuVUgfEx/ILuo=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/blog/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://tylerwcs.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://tylerwcs.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://tylerwcs.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=http://tylerwcs.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=http://tylerwcs.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="LazyAdmin [THM Walkthrough]"><meta property="og:description" content="LazyAdmin is a easy rated box on THM. It is a good box to brush up my skills and I learned a lot from it.
 Enumeration First, I run a Nmap scan and 2 open ports are found: port 80 and port 22
nmap --top-ports 50 10.10.127.148  Then, I run a gobuster scan to search for other subdirectories, and I found a /content subdirectory page.
 Exploitation I visit the page and found something new: SweetRice CMS."><meta property="og:type" content="article"><meta property="og:url" content="http://tylerwcs.github.io/blog/posts/second/"><meta property="og:image" content="http://tylerwcs.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-08T14:02:47+08:00"><meta property="article:modified_time" content="2022-03-08T14:02:47+08:00"><meta property="og:site_name" content="CS Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://tylerwcs.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="LazyAdmin [THM Walkthrough]"><meta name=twitter:description content="LazyAdmin is a easy rated box on THM. It is a good box to brush up my skills and I learned a lot from it.
 Enumeration First, I run a Nmap scan and 2 open ports are found: port 80 and port 22
nmap --top-ports 50 10.10.127.148  Then, I run a gobuster scan to search for other subdirectories, and I found a /content subdirectory page.
 Exploitation I visit the page and found something new: SweetRice CMS."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://tylerwcs.github.io/blog/posts/"},{"@type":"ListItem","position":2,"name":"LazyAdmin [THM Walkthrough]","item":"http://tylerwcs.github.io/blog/posts/second/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"LazyAdmin [THM Walkthrough]","name":"LazyAdmin [THM Walkthrough]","description":"LazyAdmin is a easy rated box on THM. It is a good box to brush up my skills and I learned a lot from it.\n Enumeration First, I run a Nmap scan and 2 open ports are found: port 80 and port 22\nnmap --top-ports 50 10.10.127.148  Then, I run a gobuster scan to search for other subdirectories, and I found a /content subdirectory page.\n Exploitation I visit the page and found something new: SweetRice CMS.","keywords":["THM"],"articleBody":"LazyAdmin is a easy rated box on THM. It is a good box to brush up my skills and I learned a lot from it.\n Enumeration First, I run a Nmap scan and 2 open ports are found: port 80 and port 22\nnmap --top-ports 50 10.10.127.148  Then, I run a gobuster scan to search for other subdirectories, and I found a /content subdirectory page.\n Exploitation I visit the page and found something new: SweetRice CMS.\nI then use searchsploit to find vulnerabilities related to this program, and I found quite a lot of them. The interesting ones are the Arbitrary File Upload and the PHP Code Execution.\nLooking at the payload, it requires credentials in order to upload the file, so I had to find a way to find creds.\nAfter poking around, I cant find anything, so I run another gobuster scan on the /content directory. It turns out, the real thing is inside here.\nI went to check the /inc sub directory, and it had lots of files in it, but one file is super interesting: mysql_backup/\nBOOOM! There are creds inside the backup file.But the password seems to be encrypted.\nSo I went to decrypt the password and got the plaintext: Password123\nI quickly went back to the exploit and key in all the creds along with the reverse shell I made from pentestmonkey. But I cant seem to get it to work…\nI was quite stuck at this moment.. then I looked back my scans and see if theres anything more left, and I found out that the /as page was the login panel for the website!\nI then key in my creds and logged in to the website. manager:Password123\nI then poked around and found out that the Ads section can allow me to inject code. I then copied the reverse shell PHP code from pentestmonkey and edit it with my own IP address and port.\nThen I went back to the /inc page and access my shell there..\nAnd then BOOM, I got a shell back!\nI quickly get the user.txt file and submit it.\n Privilege Escalation The fastest way to priv esc is to use sudo -l, and indeed it listed something we can use. We can run the backup.pl script as root, so all we have to do is replace the content of the script and run it as sudo.\nReplace the file content with a reverse shell and run the script using sudo.\nAnd BOOOM, we are root!\n That’s it for this box, thanks for reading!\n","wordCount":"426","inLanguage":"en","datePublished":"2022-03-08T14:02:47+08:00","dateModified":"2022-03-08T14:02:47+08:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://tylerwcs.github.io/blog/posts/second/"},"publisher":{"@type":"Organization","name":"CS's Blog","logo":{"@type":"ImageObject","url":"http://tylerwcs.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://tylerwcs.github.io/blog/ accesskey=h title="CS's Blog (Alt + H)">CS's Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=http://tylerwcs.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://tylerwcs.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://tylerwcs.github.io/blog/archives/ title=Archives><span>Archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://tylerwcs.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=http://tylerwcs.github.io/blog/posts/>Posts</a></div><h1 class=post-title>LazyAdmin [THM Walkthrough]</h1><div class=post-meta><span title="2022-03-08 14:02:47 +0800 +0800">March 8, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/second.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>LazyAdmin is a easy rated box on THM. It is a good box to brush up my skills and I learned a lot from it.</p><hr><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>First, I run a <code>Nmap</code> scan and 2 open ports are found: port <strong>80</strong> and port <strong>22</strong></p><pre><code>nmap --top-ports 50 10.10.127.148
</code></pre><p><img loading=lazy src=../../img/lazy1.png alt></p><p>Then, I run a gobuster scan to search for other subdirectories, and I found a <code>/content</code> subdirectory page.</p><p><img loading=lazy src=../../img/lazy2.png alt></p><hr><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>I visit the page and found something new: <code>SweetRice CMS</code>.</p><p><img loading=lazy src=../../img/lazy3.png alt></p><p>I then use <code>searchsploit</code> to find vulnerabilities related to this program, and I found quite a lot of them. The interesting ones are the Arbitrary <strong>File Upload</strong> and the <strong>PHP Code Execution</strong>.</p><p><img loading=lazy src=../../img/lazy4.png alt></p><p>Looking at the payload, it requires credentials in order to upload the file, so I had to find a way to find creds.</p><p>After poking around, I cant find anything, so I run another <code>gobuster</code> scan on the <code>/content</code> directory. It turns out, the real thing is inside here.</p><p><img loading=lazy src=../../img/lazy5.png alt></p><p>I went to check the /inc sub directory, and it had lots of files in it, but one file is super interesting: <code>mysql_backup/</code></p><p><img loading=lazy src=../../img/lazy6.png alt></p><p>BOOOM! There are creds inside the backup file.But the password seems to be encrypted.</p><p><img loading=lazy src=../../img/lazy7.png alt></p><p>So I went to decrypt the password and got the plaintext: <code>Password123</code></p><p>I quickly went back to the exploit and key in all the creds along with the reverse shell I made from <em>pentestmonkey</em>. But I cant seem to get it to work&mldr;</p><p><img loading=lazy src=../../img/lazy8.png alt></p><p>I was quite stuck at this moment.. then I looked back my scans and see if theres anything more left, and I found out that the <code>/as</code> page was the login panel for the website!</p><p><img loading=lazy src=../../img/lazy9.png alt></p><p>I then key in my creds and logged in to the website. <code>manager:Password123</code></p><p><img loading=lazy src=../../img/lazy10.png alt></p><p>I then poked around and found out that the Ads section can allow me to inject code. I then copied the reverse shell PHP code from <em>pentestmonkey</em> and edit it with my own IP address and port.</p><p><img loading=lazy src=../../img/lazy11.png alt></p><p>Then I went back to the <code>/inc</code> page and access my shell there..</p><p>And then BOOM, I got a shell back!</p><p><img loading=lazy src=../../img/lazy12.png alt></p><p>I quickly get the <em><strong>user.txt</strong></em> file and submit it.</p><p><img loading=lazy src=../../img/lazy13.png alt></p><hr><h2 id=privilege-escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><p>The fastest way to priv esc is to use <code>sudo -l</code>, and indeed it listed something we can use. We can run the <code>backup.pl</code> script as root, so all we have to do is replace the content of the script and run it as sudo.</p><p><img loading=lazy src=../../img/lazy14.png alt></p><p>Replace the file content with a reverse shell and run the script using sudo.</p><p><img loading=lazy src=../../img/lazy15.png alt></p><p>And BOOOM, we are root!</p><p><img loading=lazy src=../../img/lazy16.png alt></p><hr><p>That&rsquo;s it for this box, thanks for reading!</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://tylerwcs.github.io/blog/tags/thm/>THM</a></li></ul><nav class=paginav><a class=next href=http://tylerwcs.github.io/blog/posts/first/><span class=title>Next Page »</span><br><span>Burp Suite</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=http://tylerwcs.github.io/blog/>CS's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>
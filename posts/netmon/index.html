<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Netmon [HTB Walkthrough] | CS's Blog</title><meta name=keywords content="HTB"><meta name=description content="Knowledge Gained ðŸ™‰  psexec Windows File System   Enumeration First off, we scan the machine and noticed a lot of ports opened. WinRM (Windows Remote Management) is a Microsoft protocol that allows remote management of Windows machines over HTTP(S) using SOAP. On the backend it&rsquo;s utilising WMI, so you can think of it as an HTTP based API for WMI.
I first start off with the ftp server and check if the server allows anonymous acces."><meta name=author content="CS"><link rel=canonical href=http://tylerwcs.github.io/blog/posts/netmon/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.min.c3b13d75145d6a6f51292c0e666f8c51abbe73ff86acee40d5fd335af8a46763.css integrity="sha256-w7E9dRRdam9RKSwOZm+MUau+c/+GrO5A1f0zWvikZ2M=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/blog/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://tylerwcs.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://tylerwcs.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://tylerwcs.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=http://tylerwcs.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=http://tylerwcs.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Netmon [HTB Walkthrough]"><meta property="og:description" content="Knowledge Gained ðŸ™‰  psexec Windows File System   Enumeration First off, we scan the machine and noticed a lot of ports opened. WinRM (Windows Remote Management) is a Microsoft protocol that allows remote management of Windows machines over HTTP(S) using SOAP. On the backend it&rsquo;s utilising WMI, so you can think of it as an HTTP based API for WMI.
I first start off with the ftp server and check if the server allows anonymous acces."><meta property="og:type" content="article"><meta property="og:url" content="http://tylerwcs.github.io/blog/posts/netmon/"><meta property="og:image" content="http://tylerwcs.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-28T21:04:00+08:00"><meta property="article:modified_time" content="2022-04-28T21:04:00+08:00"><meta property="og:site_name" content="CS Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://tylerwcs.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Netmon [HTB Walkthrough]"><meta name=twitter:description content="Knowledge Gained ðŸ™‰  psexec Windows File System   Enumeration First off, we scan the machine and noticed a lot of ports opened. WinRM (Windows Remote Management) is a Microsoft protocol that allows remote management of Windows machines over HTTP(S) using SOAP. On the backend it&rsquo;s utilising WMI, so you can think of it as an HTTP based API for WMI.
I first start off with the ftp server and check if the server allows anonymous acces."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://tylerwcs.github.io/blog/posts/"},{"@type":"ListItem","position":2,"name":"Netmon [HTB Walkthrough]","item":"http://tylerwcs.github.io/blog/posts/netmon/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Netmon [HTB Walkthrough]","name":"Netmon [HTB Walkthrough]","description":"Knowledge Gained ðŸ™‰  psexec Windows File System   Enumeration First off, we scan the machine and noticed a lot of ports opened. WinRM (Windows Remote Management) is a Microsoft protocol that allows remote management of Windows machines over HTTP(S) using SOAP. On the backend it\u0026rsquo;s utilising WMI, so you can think of it as an HTTP based API for WMI.\nI first start off with the ftp server and check if the server allows anonymous acces.","keywords":["HTB"],"articleBody":" Knowledge Gained ðŸ™‰  psexec Windows File System   Enumeration First off, we scan the machine and noticed a lot of ports opened. WinRM (Windows Remote Management) is a Microsoft protocol that allows remote management of Windows machines over HTTP(S) using SOAP. On the backend itâ€™s utilising WMI, so you can think of it as an HTTP based API for WMI.\nI first start off with the ftp server and check if the server allows anonymous acces. And it does!\nSuprisingly, the user flag is get right there! I downloaded it using the get command.\nAfter that, I move on to the website, the website is a monitor program that needs login.\nI then googled for default creds for the program, and found one default creds. But unfortunately, the default creds did not work.\nThen, I thought that since I have access to the ftp server, maybe I can view the configuration files/ database files for the program. So, I searched up where does the config/database files are stored. So it is stored at \\ProgramData\\Paessler\\PRTG Network Monitor\nI then use the ftp server to access the location and found 3 config files inside. I downloaded them all to my local machine to take a look at whats inside.\nIn the PRTG Configuration.old.bak file, theres a set of credentials in it! I grabbed the creds and use it on the login page. Suprisingly, it did not work.\nThe is where a little bit of creativity is needed. As this file is a old backup file from 2018, most likely the password is out of date. So the user might changed it to another date such as PrTg@dmin2019\n And it worked! The correct creds is prtgadmin:PrTg@dmin2019\n Foothold During enumeration phase, I noticed that there is one exploit for the PRTG program, that is the Authenticated RCE exploit. I looked it up using searchploit and copied it down to my machine.\nI ran the script and it worked!\n Privilege Escalation I then use psexec.py with the creds we have and we are root!\nThats all for this machine, thanks for reading!\n","wordCount":"346","inLanguage":"en","datePublished":"2022-04-28T21:04:00+08:00","dateModified":"2022-04-28T21:04:00+08:00","author":{"@type":"Person","name":"CS"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://tylerwcs.github.io/blog/posts/netmon/"},"publisher":{"@type":"Organization","name":"CS's Blog","logo":{"@type":"ImageObject","url":"http://tylerwcs.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://tylerwcs.github.io/blog/ accesskey=h title="CS's Blog (Alt + H)">CS's Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=http://tylerwcs.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://tylerwcs.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://tylerwcs.github.io/blog/archives/ title=Archives><span>Archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://tylerwcs.github.io/blog/>Home</a>&nbsp;Â»&nbsp;<a href=http://tylerwcs.github.io/blog/posts/>Posts</a></div><h1 class=post-title>Netmon [HTB Walkthrough]</h1><div class=post-meta><span title="2022-04-28 21:04:00 +0800 +0800">April 28, 2022</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;CS&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/netmon.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><hr><h3 id=knowledge-gained->Knowledge Gained ðŸ™‰<a hidden class=anchor aria-hidden=true href=#knowledge-gained->#</a></h3><ul><li>psexec</li><li>Windows File System</li></ul><hr><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>First off, we scan the machine and noticed a lot of ports opened. <code>WinRM </code>(Windows Remote Management) is a Microsoft protocol that allows remote management of Windows machines over HTTP(S) using SOAP. On the backend it&rsquo;s utilising WMI, so you can think of it as an HTTP based API for WMI.</p><p><img loading=lazy src=../../img/net1.png alt></p><p>I first start off with the ftp server and check if the server allows <strong>anonymous</strong> acces. And it does!</p><p><img loading=lazy src=../../img/net2.png alt></p><p>Suprisingly, the user flag is get right there! I downloaded it using the get command.</p><p><img loading=lazy src=../../img/net3.png alt></p><p>After that, I move on to the website, the website is a monitor program that needs login.</p><p><img loading=lazy src=../../img/net4.png alt></p><p>I then googled for default creds for the program, and found one default creds. But unfortunately, the default creds did not work.</p><p><img loading=lazy src=../../img/net6.png alt></p><p>Then, I thought that since I have access to the ftp server, maybe I can view the <strong>configuration files/ database files</strong> for the program. So, I searched up where does the config/database files are stored. So it is stored at <code>\ProgramData\Paessler\PRTG Network Monitor</code></p><p><img loading=lazy src=../../img/net5.png alt></p><p>I then use the <code>ftp</code> server to access the location and found <strong>3</strong> config files inside. I downloaded them all to my local machine to take a look at whats inside.</p><p><img loading=lazy src=../../img/net7.png alt></p><p>In the <code>PRTG Configuration.old.bak</code> file, theres a set of credentials in it! I grabbed the creds and use it on the login page. Suprisingly, it did not work.</p><p><img loading=lazy src=../../img/net8.png alt></p><p>The is where a little bit of creativity is needed. As this file is a old backup file from <strong>2018</strong>, most likely the password is out of date. So the user might changed it to another date such as <code>PrTg@dmin2019</code></p><h1 id=heading><a hidden class=anchor aria-hidden=true href=#heading>#</a></h1><p>And it worked! The correct creds is <code>prtgadmin:PrTg@dmin2019</code></p><p><img loading=lazy src=../../img/net9.png alt></p><hr><h2 id=foothold>Foothold<a hidden class=anchor aria-hidden=true href=#foothold>#</a></h2><p>During enumeration phase, I noticed that there is one exploit for the PRTG program, that is the <a href=https://www.exploit-db.com/exploits/46527>Authenticated RCE exploit</a>. I looked it up using <code>searchploit</code> and copied it down to my machine.</p><p><img loading=lazy src=../../img/net10.png alt></p><p>I ran the script and it worked!</p><p><img loading=lazy src=../../img/net11.png alt></p><p><img loading=lazy src=../../img/net12.png alt></p><hr><h2 id=privilege-escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><p>I then use <a href=https://www.infosecmatter.com/rce-on-windows-from-linux-part-1-impacket/>psexec.py</a> with the creds we have and we are root!</p><p><img loading=lazy src=../../img/net13.png alt></p><p>Thats all for this machine, thanks for reading!</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://tylerwcs.github.io/blog/tags/htb/>HTB</a></li></ul><nav class=paginav><a class=next href=http://tylerwcs.github.io/blog/posts/cap/><span class=title>Next Page Â»</span><br><span>Cap [HTB Walkthrough]</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=http://tylerwcs.github.io/blog/>CS's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>
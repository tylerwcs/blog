<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Backdoor [HTB Walkthrough] | CS's Blog</title><meta name=keywords content="HTB"><meta name=description content="Knowledge Gained ðŸ™‰  LFI and Directory Traversal gdbserver screen rustscan wpscan   Enumeration In this machine, I learned a new way to scan for open ports, that is using rustscan. It took less than few seconds for it to find the ports open and it also runs nmap automatically. The scan shows that we have 3 open ports running, port 22, 80 and 1337.
First I took a look at the port 80 website, it shows that it is a website built using Wordpress, therefore we can run wpscan to enumerate more infos about the website."><meta name=author content="CS"><link rel=canonical href=http://tylerwcs.github.io/blog/posts/third/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.min.c3b13d75145d6a6f51292c0e666f8c51abbe73ff86acee40d5fd335af8a46763.css integrity="sha256-w7E9dRRdam9RKSwOZm+MUau+c/+GrO5A1f0zWvikZ2M=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/blog/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://tylerwcs.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://tylerwcs.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://tylerwcs.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=http://tylerwcs.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=http://tylerwcs.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Backdoor [HTB Walkthrough]"><meta property="og:description" content="Knowledge Gained ðŸ™‰  LFI and Directory Traversal gdbserver screen rustscan wpscan   Enumeration In this machine, I learned a new way to scan for open ports, that is using rustscan. It took less than few seconds for it to find the ports open and it also runs nmap automatically. The scan shows that we have 3 open ports running, port 22, 80 and 1337.
First I took a look at the port 80 website, it shows that it is a website built using Wordpress, therefore we can run wpscan to enumerate more infos about the website."><meta property="og:type" content="article"><meta property="og:url" content="http://tylerwcs.github.io/blog/posts/third/"><meta property="og:image" content="http://tylerwcs.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-19T14:38:29+08:00"><meta property="article:modified_time" content="2022-04-19T14:38:29+08:00"><meta property="og:site_name" content="CS Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://tylerwcs.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Backdoor [HTB Walkthrough]"><meta name=twitter:description content="Knowledge Gained ðŸ™‰  LFI and Directory Traversal gdbserver screen rustscan wpscan   Enumeration In this machine, I learned a new way to scan for open ports, that is using rustscan. It took less than few seconds for it to find the ports open and it also runs nmap automatically. The scan shows that we have 3 open ports running, port 22, 80 and 1337.
First I took a look at the port 80 website, it shows that it is a website built using Wordpress, therefore we can run wpscan to enumerate more infos about the website."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://tylerwcs.github.io/blog/posts/"},{"@type":"ListItem","position":2,"name":"Backdoor [HTB Walkthrough]","item":"http://tylerwcs.github.io/blog/posts/third/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Backdoor [HTB Walkthrough]","name":"Backdoor [HTB Walkthrough]","description":"Knowledge Gained ðŸ™‰  LFI and Directory Traversal gdbserver screen rustscan wpscan   Enumeration In this machine, I learned a new way to scan for open ports, that is using rustscan. It took less than few seconds for it to find the ports open and it also runs nmap automatically. The scan shows that we have 3 open ports running, port 22, 80 and 1337.\nFirst I took a look at the port 80 website, it shows that it is a website built using Wordpress, therefore we can run wpscan to enumerate more infos about the website.","keywords":["HTB"],"articleBody":" Knowledge Gained ðŸ™‰  LFI and Directory Traversal gdbserver screen rustscan wpscan   Enumeration In this machine, I learned a new way to scan for open ports, that is using rustscan. It took less than few seconds for it to find the ports open and it also runs nmap automatically. The scan shows that we have 3 open ports running, port 22, 80 and 1337.\nFirst I took a look at the port 80 website, it shows that it is a website built using Wordpress, therefore we can run wpscan to enumerate more infos about the website. There are lots of WP plugins that are vulnerable, so we can try if we can find any vulnerable ones.\nwpscan --url http://backdoor.htb/ Looks like we have found nothing interesting from the scan, there are no plugins found(via passive mode), but theres is another way of finding plugins that is using aggresive mode. But before we can use that mode, we need to singup to wpscan in order to get the api-token. After using the api-token, we can see more results from the wpscan, we have found one plugins that is vulnerable, and one user named admin.\nwpscan --url http://backdoor.htb/ --api-token G4Zkc6WaaftaniPUQYnDEdV6JxwdK7eo0oj2YkI9Jrw -e p,u --plugins-detection aggressive Following the plugins, we have found another plugins named ebook in the plugins page. Looking through the readme.txt we know that the version is 1.1 and it is vulnerable.\nLooking at the exploit, it seems to be a Directory Traversal vulnerability, which can allow us to read files from the url itself.\nAfter looking at the contents of the wp-config.php file, I found some creds!\nHowever, I tried logging in using the creds but nothing worked.\nI then tried listing other files that are interesting like the /etc/passwd file, but nothing interesting.\n Foothold Since there is a port 1337 listening, I decided to try enumerating processes. So, /proc/[PID]/cmdline in Linux is basically representing a currently running process. More on the article here.\n I used wfuzz to bruteforce through the PID and got back 4 processes. Wfuzz is based on a simple concept: it replaces any reference to the FUZZ keyword by the value of a given payload.\nwfuzz -u http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/FUZZ/cmdline -z range,1-1000 --hw 1 I then listed out all the PIDs and see what are they running.\nOn** PID 822**, there is a gdbserver running on port 1337, that might be the one we are looking for. So I searched up the exploit and found one here using metasploit.\nI run the exploit and got a shell back. I then access the user flag.\n Priv Esc I used LinPeas to do more enumeration on the machine, then I found something interesting, a screen process is running as root.\nAfter doing some research, I found out that I can use the -x command to attach to a session. Since root has already opened a session, I just need to attach to it using the command:\nscreen -x root/root First, we have to set the terminal emulator to Linux by using export TERM=xterm. You can check your TERM setting by running echo $TERM. Now just run the screen command as shown.\nAnd thats all for this machine, thanks for reading!\n","wordCount":"529","inLanguage":"en","datePublished":"2022-04-19T14:38:29+08:00","dateModified":"2022-04-19T14:38:29+08:00","author":{"@type":"Person","name":"CS"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://tylerwcs.github.io/blog/posts/third/"},"publisher":{"@type":"Organization","name":"CS's Blog","logo":{"@type":"ImageObject","url":"http://tylerwcs.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://tylerwcs.github.io/blog/ accesskey=h title="CS's Blog (Alt + H)">CS's Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=http://tylerwcs.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://tylerwcs.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://tylerwcs.github.io/blog/archives/ title=Archives><span>Archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://tylerwcs.github.io/blog/>Home</a>&nbsp;Â»&nbsp;<a href=http://tylerwcs.github.io/blog/posts/>Posts</a></div><h1 class=post-title>Backdoor [HTB Walkthrough]</h1><div class=post-meta><span title="2022-04-19 14:38:29 +0800 +0800">April 19, 2022</span>&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;CS&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/third.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><hr><h3 id=knowledge-gained->Knowledge Gained ðŸ™‰<a hidden class=anchor aria-hidden=true href=#knowledge-gained->#</a></h3><ul><li>LFI and Directory Traversal</li><li>gdbserver</li><li>screen</li><li>rustscan</li><li>wpscan</li></ul><hr><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>In this machine, I learned a new way to scan for open ports, that is using <a href=https://github.com/RustScan/RustScan>rustscan</a>. It took less than few seconds for it to find the ports open and it also runs nmap automatically. The scan shows that we have 3 open ports running, port <strong>22</strong>, <strong>80</strong> and <strong>1337</strong>.</p><p><img loading=lazy src=../../img/back1.png alt></p><p>First I took a look at the <strong>port 80</strong> website, it shows that it is a website built using <em><strong>Wordpress</strong></em>, therefore we can run <code>wpscan</code> to enumerate more infos about the website. There are lots of WP plugins that are vulnerable, so we can try if we can find any vulnerable ones.</p><pre tabindex=0><code>wpscan --url http://backdoor.htb/ 
</code></pre><p><img loading=lazy src=../../img/back2.png alt></p><p>Looks like we have found nothing interesting from the scan, there are no plugins found(via passive mode), but theres is another way of finding plugins that is using <strong>aggresive mode</strong>. But before we can use that mode, we need to singup to wpscan in order to get the <strong>api-token</strong>. After using the api-token, we can see more results from the wpscan, we have found one plugins that is vulnerable, and one user named <em><strong>admin</strong></em>.</p><pre tabindex=0><code>wpscan --url http://backdoor.htb/ --api-token G4Zkc6WaaftaniPUQYnDEdV6JxwdK7eo0oj2YkI9Jrw -e p,u --plugins-detection aggressive
</code></pre><p><img loading=lazy src=../../img/back3.png alt></p><p>Following the plugins, we have found another plugins named <code>ebook</code> in the plugins page. Looking through the readme.txt we know that the version is <strong>1.1</strong> and it is <a href=https://www.exploit-db.com/exploits/39575>vulnerable</a>.</p><p><img loading=lazy src=../../img/back4.png alt></p><p><img loading=lazy src=../../img/back5.png alt></p><p>Looking at the exploit, it seems to be a <em><strong>Directory Traversal</strong></em> vulnerability, which can allow us to read files from the url itself.</p><p><img loading=lazy src=../../img/back6.png alt></p><p>After looking at the contents of the <code>wp-config.php</code> file, I found some creds!</p><p><img loading=lazy src=../../img/back7.png alt></p><p>However, I tried logging in using the creds but nothing worked.</p><p><img loading=lazy src=../../img/back8.png alt></p><p>I then tried listing other files that are interesting like the <code>/etc/passwd</code> file, but nothing interesting.</p><p><img loading=lazy src=../../img/back9.png alt></p><hr><h2 id=foothold>Foothold<a hidden class=anchor aria-hidden=true href=#foothold>#</a></h2><p>Since there is a port 1337 listening, I decided to try enumerating processes. So, <code>/proc/[PID]/cmdline</code> in Linux is basically representing a currently running process.
More on the article <a href=https://www.netspi.com/blog/technical/web-application-penetration-testing/directory-traversal-file-inclusion-proc-file-system/>here.</a></p><p><img loading=lazy src=../../img/back10.png alt></p><h1 id=heading><a hidden class=anchor aria-hidden=true href=#heading>#</a></h1><p>I used <a href=https://wfuzz.readthedocs.io/en/latest/>wfuzz</a> to bruteforce through the PID and got back <strong>4</strong> processes. <code>Wfuzz</code> is based on a simple concept: it replaces any reference to the FUZZ keyword by the value of a given payload.</p><pre tabindex=0><code>wfuzz -u http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/FUZZ/cmdline -z range,1-1000 --hw 1
</code></pre><p>I then listed out all the PIDs and see what are they running.</p><p><img loading=lazy src=../../img/back11.png alt></p><p><img loading=lazy src=../../img/back12.png alt></p><p>On** PID 822**, there is a <code>gdbserver</code> running on port 1337, that might be the one we are looking for. So I searched up the exploit and found one <a href=https://www.rapid7.com/db/modules/exploit/multi/gdb/gdb_server_exec/>here</a> using metasploit.</p><p><img loading=lazy src=../../img/back13.png alt></p><p>I run the exploit and got a shell back. I then access the user flag.</p><p><img loading=lazy src=../../img/back14.png alt></p><hr><h2 id=priv-esc>Priv Esc<a hidden class=anchor aria-hidden=true href=#priv-esc>#</a></h2><p>I used <code>LinPeas</code> to do more enumeration on the machine, then I found something interesting, a <code>screen</code> process is running as root.</p><p><img loading=lazy src=../../img/back16.png alt></p><p><img loading=lazy src=../../img/back15.png alt></p><p>After doing some research, I found out that I can use the <code>-x</code> command to attach to a session. Since root has already opened a session, I just need to attach to it using the command:</p><pre tabindex=0><code>screen -x root/root
</code></pre><p>First, we have to set the terminal emulator to Linux by using <code>export TERM=xterm</code>. You can check your TERM setting by running <code>echo $TERM</code>. Now just run the screen command as shown.</p><p><img loading=lazy src=../../img/back17.png alt></p><p><img loading=lazy src=../../img/back18.png alt></p><p>And thats all for this machine, thanks for reading!</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://tylerwcs.github.io/blog/tags/htb/>HTB</a></li></ul><nav class=paginav><a class=next href=http://tylerwcs.github.io/blog/posts/second/><span class=title>Next Page Â»</span><br><span>LazyAdmin [THM Walkthrough]</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=http://tylerwcs.github.io/blog/>CS's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>